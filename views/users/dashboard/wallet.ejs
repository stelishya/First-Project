<!-- Header -->
<%- include('../../partials/user/header',{search}) %>

<style>
    .wallet-card {
        background: #fff8f3;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(251, 146, 60, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .wallet-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 15px rgba(251, 146, 60, 0.15);
    }

    .balance-section {
        background: linear-gradient(135deg, #eae8e6 0%, #b6b4b3 100%);
        border: 2px solid #767574;
        color: #333231;
        border-radius: 8px;
        padding: 2rem;
        margin-bottom: 2rem;
        transition: all 0.3s ease;
    }

    .amount-btn {
        background-color: #fff7ed;
        color: #5a5857;
        transition: all 0.3s ease;
        border: 2px solid #3a3937;
        border-radius: 8px;
        padding: 0.75rem 1.5rem;
        font-weight: 600;
    }

    .amount-btn:hover {
        background-color: #ffedd5;
        border-color: #4a4948;
        color: #424241;
        transform: scale(1.05);
    }

    .add-money-btn {
        background-color: #494847;
        color: snow;
        transition: all 0.3s ease;
        font-weight: 600;
    }

    .add-money-btn:hover {
        background-color: #767372;
        border-color: #3a3838;
        color: white;
        transform: scale(1.02);
    }

    .input-amount {
        transition: all 0.3s ease;
        border: 2px solid #82807e;
        border-radius: 8px;
        background-color: #fff7ed;
    }

    .input-amount:focus {
        border-color: #3e3d3b;
        background-color: white;
        box-shadow: 0 0 0 3px rgba(251, 146, 60, 0.2);
    }

    .toast {
        position: fixed;
        top: 1rem;
        right: 1rem;
        padding: 1rem 2rem;
        border-radius: 8px;
        color: white;
        opacity: 0;
        transform: translateY(-20px);
        transition: all 0.3s ease;
    }

    .toast.success {
        background-color: #84cc16;
        border: 2px solid #65a30d;
    }

    .toast.error {
        background-color: #f87171;
        border: 2px solid #dc2626;
    }

    .toast.show {
        opacity: 1;
        transform: translateY(0);
    }

    .transaction-card {
        background-color: #fff7ed;
        border: 1px solid #454443;
        transition: all 0.3s ease;
    }

    .transaction-card:hover {
        transform: translateX(5px);
        border-color: #787675;
        background-color: #ffedd5;
    }
</style>

<nav>
    <div class="nav-links">
     <a href="/user/home">
      Home
     </a>
     <span class="divider">
     </span>
     <a href="#">
      Contact
     </a>
     <span class="divider">
     </span>
     <a href="#">
      About
     </a>
     <span class="divider">
     </span>
     <a href="/user/products">
      Products
     </a>
    </div>
   </nav>

<!-- Main Content -->
<main class="flex">
    <!-- Sidebar -->
    <%- include('../../partials/user/dashboard_sideBar') %>

    <!-- Main Section -->
    <section class="p-6 w-4/5" style="background-color: rgb(211, 208, 206);">

        <!-- <div class="wallet-card p-6">
            <nav class="flex mb-4 bg-gray-400 rounded" aria-label="Breadcrumb">
                <ol class="inline-flex items-center space-x-1 md:space-x-3">
                    <li class="inline-flex items-center">
                        <a href="/user/wallet" class="inline-flex items-center text-gray-700 hover:text-white-600">
                            <svg class="w-4 h-4 mr-2 " fill="currentColor" viewBox="0 0 20 20">
                                <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path>
                            </svg>
                            Payments
                        </a>
                    </li>
                    
                    <li aria-current="page">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-gray-200" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            <span class="ml-1 text-gray-500 md:ml-2">Wallet</span> -->


        <div class="wallet-card p-8">
            <div class="balance-section text-center">
                <h2 class="text-2xl font-bold mb-2">Current Balance</h2>
                <div class="text-4xl font-bold text-gray-800 mb-4" id="walletBalance">
                    ₹<%= userWallet ? userWallet.balance.toFixed(2) : '0.00' %>
                </div>

            <!-- </li>
        </ol>
    </nav>
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-700">My Wallet</h2> -->

            </div>
            
            <div class="grid grid-cols-3 gap-4 mb-8">
                <button onclick="addAmount(100)" class="amount-btn">₹100</button>
                <button onclick="addAmount(500)" class="amount-btn">₹500</button>
                <button onclick="addAmount(1000)" class="amount-btn">₹1000</button>
            </div>
            
            <div class="text-center">
                <input type="number" id="customAmount" placeholder="Enter amount" min="1" 
                    class="p-2 border rounded-lg mb-4 w-48">
                <button onclick="addCustomAmount()" class="add-money-btn px-6 py-3 rounded-lg">
                    Add Money to Wallet
                </button>
            </div>
        </div>
    </section>
</main>

<!-- Toast Container -->
<div id="toast" class="toast"></div>

<!-- Footer -->
<%- include('../../partials/user/footer') %>

<script>
async function addAmount(amount) {
    try {
        const response = await fetch('/user/wallet/add', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ amount })
        });

        const data = await response.json();
        if (data.success) {
            // Update wallet balance display
            document.getElementById('walletBalance').textContent = `₹${data.newBalance.toFixed(2)}`;
            showToast('Amount added successfully', 'success');
        } else {
            showToast(data.message || 'Error adding amount', 'error');
        }
    } catch (error) {
        console.error('Error:', error);
        showToast('Error adding amount', 'error');
    }
}

function addCustomAmount() {
    const amount = document.getElementById('customAmount').value;
    if (!amount || amount <= 0) {
        showToast('Please enter a valid amount', 'error');
        return;
    }
    addAmount(Number(amount));
}

function showToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.className = `toast ${type}`;
    toast.style.display = 'block';
    setTimeout(() => {
        toast.style.display = 'none';
    }, 3000);
}
</script>