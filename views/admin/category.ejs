<%-  include ('../partials/admin/sidebar')%>
<title>
   Customer Management
  </title>
  <link rel="stylesheet" href="/Admin/css/category.css">
  <div class="container">
   <div class="main-content">
    <div class="header">
    <form action="/admin/category" method="get" class="d-inline" >
     <div class="search-bar">
      <input placeholder="Search categories..." type="text"/>
      <button>
       <i class="fas fa-search">
       </i>
      </button>
     </div>
    </form>
     <div class="user-info">
      <img alt="User profile picture" height="40" src="https://storage.googleapis.com/a1aa/image/6Frmd66qfz37V6OkvJHOKto7rafaEUORfStf9uiesPYqTb5eE.jpg" width="40"/>
      <div>
       <!-- <div class="name">%= user.adminName %></div> -->
        <!-- Selin Stelishya Oliver -->
       <div class="role">Admin</div>
      </div>
     </div>
    </div>
    <div style="display: flex; gap: 20px; margin-top: 20px;">
    <div class="col-md-3">
        <form method="post" action="/admin/addCategory" onsubmit="return handleFormSubmit()">
          <div class="mb-4">
            <label for="product_name" class="form-label">Name</label>
            <input type="text" name="name" placeholder="Type here" class="form-control" id="product_name" />
            <div id="name-error" class="error-message"></div>
          </div>
          <div class="mb-4">
            <label class="form-label">Description</label>
            <textarea placeholder="Type here" name="description" class="form-control" id="descriptionId" ></textarea>
            <div id="description-error" class="error-message"></div>
          </div>
          <div class="d-grid">
            <button class="btn btn-primary" type="submit">
              Create category
            </button>
          </div>
        </form>
      </div>

        <div id="offerDiv" style="display: none; width: 200px; padding: 20px; background-color: #fff; border-radius: 5px; height: fit-content; margin-top: 10px;">
          <h4>Add Offer</h4>
          <div class="mb-3">
            <label class="form-label">Offer Percentage</label>
            <input type="number" class="form-control" id="offerInput" placeholder="Enter %" min="0" max="100">
          </div>
          <!-- <button type="button" class="swal2-confirm swal-2-styled" aria-label style="display:inline-block">OK</button> -->
          <!-- <button type="button" class="swal2-cancel swal-2-styled" aria-label style="display:none">Cancel</button> -->
        </div>
    </div>

    <div class="table-container">
     <table>
      <thead>
       <tr>
        <!-- <th>
         <input type="checkbox"/>
        </th> -->
        <th>Category Name</th>
        <th>Description</th>
        <th>Offer Price</th>
        <th>Offer</th>
        <th>Status</th>
        <th>List/Unlist</th>
        <th class="text-start">Edit</th>
        <!-- <th>
            Sales
        </th>
        <th>
            Stock
        </th>
        <th>
            Added
        </th> -->
        
        
        <!-- <th>
         Action
        </th> -->
        
       </tr>
      </thead>
      <tbody>
        <% cat.reverse().forEach((category,index)=>{%>
       <tr>
        <!-- <td>
         <input type="checkbox"/>
        </td> -->
        <td class="text-start"><%= category.name %></td>
        <td class="text-start"><%= category.description %></td>
        <td>
            <% if(category.categoryOffer){ %>
                <%= category.categoryOffer %>
            <% } else{ %>
                0%
            <% } %>
        </td>
        <td class="text-start">
            <% if(category.categoryOffer === 0){ %>
                <button class="btn btn-info" style="width:100px">
                    <a href="#" class="text-white" onclick="addOffer('<%= category._id %>',event)">Add Offer</a>
                </button>
            <% } else{%>
            <button class="btn btn-info" style="width:100px">
                <a href="#" class="text-white" onclick="removeOffer('<%= category._id %>')">Remove</a>
            </button>
            <% } %>
        </td>
        <td class="text-start">
            <% if(category.isListed){ %>
            <span 
            class="badge rounded-pill alert-success" 
            style="width:60px"
            >Listed</span>
            <% } else{%>
            <span 
            class="badge rounded-pill alert-danger" 
            style="width:60px"
            >UnListed</span>
            <% } %>
        </td>
        <td class="text-start">
            <% if(category.isListed){%>
        <button class="btn btn-danger" style="width:70px">
            <a href="/admin/listCategory?id=<%=category._id%>" class="text-white">Unlist</a>
        </button>
        <% } else{%>
        <button class="btn btn-danger" style="width:70px">
            <a href="/admin/unlistCategory?id=<%=category._id%>" class="text-white">List</a>
        </button>
        <% } %>
        </td>
        <td class="text-start">
            <a href="/admin/editCategory?id=<%= category._id %>" class="btn btn-info text-white">Edit</a>
        </td>
    </tr>
    <% }) %>
       
      </tbody>
     </table>
     <div class="pagination">
      <div class="showing-info">
        <!-- Showing %= ((currentPage -1)*3) + 1 %> - %= Math.min(currentPage * 3 , count) %> from %= count %> -->
       <!-- Showing 1-10 from 100 -->
      </div>
      <div class="pagination-container">
        <% if(currentPage > 1) {%>
        <a href="?page=<%= currentPage - 1 %>">&laquo; Previous</a>
        <% } %><% for(let i=1;i <= totalPages;i++) {%> <% if(i === currentPage){ %>
        <span class="current-page"><%= i %></span>
        <% }else { %>
        <a href="?page=<%= i %>"><%= i %></a>
        <% } %> <% } %> 
        <% if (currentPage < totalPages){%>
        <a href="?page=<%= currentPage + 1 %>">Next &raquo;</a>
        <% } %>
      </div>
      
    </div>
   </div>
  </div>
  <script src="/Admin/jsFiles/category.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

 </body>
</html>

<%-  include ('../partials/admin/footer')%>
